<group name="firewall,Stormshield,syslog,">

<rule id="602100" level="3">  
 <decoded_as>stormshield_decoder_auth</decoded_as>  
 <description>Auth Stormshield logs grouping rule</description>  
</rule>

<rule id="602101" level="3">  
 <decoded_as>stormshield_decoder</decoded_as>  
 <description>Generic Stormshield logs grouping rule</description>  
</rule>


<rule id="602102" level="4">
  <if_sid>602101</if_sid>
  <field name="logtype">connection</field>
  <description>Stormshield connection activity - Allowed connection to $(dstip) - $(dstname)</description>
</rule>

<rule id="602103" level="4">
  <if_sid>602101</if_sid>
  <field name="logtype">alarm</field>
  <description>Stormshield alarm activity</description>
</rule>

<rule id="602104" level="4">
  <if_sid>602101</if_sid>
  <field name="logtype">plugin</field>
  <description>Stormshield plugin activity</description>
</rule>

<rule id="602105" level="4">
  <if_sid>602101</if_sid>
  <field name="logtype" type="pcre2">^filter$</field>
  <description>Stormshield filter activity</description>
</rule>

<rule id="602106" level="4">
  <if_sid>602101</if_sid>
  <field name="logtype">system</field>
  <description>Stormshield system activity - $(msg)</description>
</rule>

<rule id="602107" level="4">
  <if_sid>602101</if_sid>
  <field name="logtype">monitor</field>
  <description>Stormshield monitor activity</description>
</rule>

<rule id="602108" level="2">
  <if_sid>602101</if_sid>
  <field name="logtype">routerstat</field>
  <description>Stormshield routerstat activity</description>
</rule>

<rule id="602109" level="2">
  <if_sid>602101</if_sid>
  <field name="logtype">authstat</field>
  <description>Stormshield authstat activity</description>
</rule>

<rule id="602110" level="2">
  <if_sid>602101</if_sid>
  <field name="logtype">filterstat</field>
  <description>Stormshield filterstat activity</description>
</rule>

<rule id="602111" level="2">
  <if_sid>602101</if_sid>
  <field name="logtype">ipsecstat</field>
  <description>Stormshield ipsecstat activity</description>
</rule>

<rule id="602112" level="4">
  <if_sid>602101</if_sid>
  <field name="logtype">server</field>
  <description>Stormshield server activity</description>
</rule>

<rule id="602113" level="4">
  <if_sid>602101</if_sid>
  <field name="logtype">vpn</field>
  <description>Stormshield vpn activity - $(msg)</description>
</rule>

<rule id="602114" level="4">
  <if_sid>602100</if_sid>
  <field name="logtype" type="pcre2">^auth$</field>
  <description>Stormshield auth activity</description>
</rule>

<!-- Correlation rules -->

<rule id="602200" level="5">
  <if_sid>602103</if_sid>
  <action type="osregex">block</action>
  <description>Stormshield alarm activity - Blocked connection to $(dstip) - $(dstname)</description>
</rule>

<rule id="602201" level="7">
  <if_sid>602103</if_sid>
  <action type="osregex">pass</action>
  <description>Stormshield alarm activity - Signaled connection to $(dstip) - $(dstname)</description>
</rule>

<rule id="602202" level="5">
  <if_sid>602104</if_sid>
  <action type="osregex">block</action>
  <description>Stormshield plugin activity - Blocked connection to $(dstname)$(arg)</description>
</rule>

<rule id="602203" level="5">
  <if_sid>602104</if_sid>
  <action type="osregex">pass</action>
  <description>Stormshield plugin activity - Signaled connection to $(dstname)$(arg)</description>
</rule>

<rule id="602204" level="5">
  <if_sid>602105</if_sid>
  <action type="osregex">block</action>
  <description>Stormshield filter activity - Blocked connection to $(dstip)</description>
</rule>

<rule id="602205" level="7">
  <if_sid>602105</if_sid>
  <action type="osregex">pass</action>
  <description>Stormshield filter activity - Signaled connection to $(dstip)</description>
</rule>

<rule id="602206" level="5">
  <if_sid>602113</if_sid>
  <field name="msg">established</field>
  <description>Stormshield vpn activity - Starting connection from $(srcname) to $(dstname)</description>
  <group>authentication_success</group>  
</rule>

<rule id="602207" level="3">
  <if_sid>602113</if_sid>
  <field name="msg">deleted</field>
  <description>Stormshield vpn activity - Ending connection from $(srcname) to $(dstname)</description>
</rule>

<rule id="602208" level="7">
  <if_sid>602114</if_sid>
  <field name="error">0</field>
  <description>Stormshield authentication - $(user) logged in from $(srcip)</description>
  <group>authentication_success</group>
</rule>

<rule id="602209" level="7">
  <if_sid>602114</if_sid>
  <field name="error" negate="yes">0</field>
  <description>Stormshield authentication - $(user) fail to logged in from $(srcip) : $(msg)</description>
  <group>authentication_failed</group>
</rule>

</group>
